#!/bin/sh

WIDTH=1024

if [ "$1" = '-s' ]; then 
    dictopt='-d eng-spa' 
    shift
fi

echo $@

if [ $1 ]; then
    LOOKUP="$1"
else
    LOOKUP=`sselp`
fi

LOOKUP=`echo "$LOOKUP" |head -n1 |tr '_' ' '`
LOOKUP=`echo "$LOOKUP" |sed -r -e 's/[^a-zA-Z0-9 ]//g'`
LOOKUP=`echo "$LOOKUP" |awk '{print $1}'`

[ "$LOOKUP" ] || exit

znotify "$LOOKUP"

definition=`dict $dictopt "$LOOKUP"`

lines=`echo "$definition" |wc -l`
cols=`echo "$definition" |wc -L`

[ $lines -gt 30 ]&&lines=20
[ $cols -gt 80 ]&&cols=100

width=$((9*$cols))
x=$((($WIDTH-$width)/2))


(echo "$LOOKUP"; echo "$definition") | \
    dzen2 -l $lines -p -w $width -bg darkblue -fg grey75 -x $x -y 0 \
    -fn '-*-terminal-*-*-*-*-14-*-*-*-*-*-iso8859' \
    -e 'onstart=scrollhome,uncollapse;button1=togglecollapse;button4=scrollup;button5=scrolldown;button3=exit'
