#!/bin/bash
set -e
export GIT_WORK_TREE=${1:-~}
export GIT_DIR=$GIT_WORK_TREE/.dotfiles.git

if [[ $1 = '-h' || -z $1 && -d $GIT_DIR ]]; then
    echo "curl -Ls http://git.io/~dangra |bash -"
    echo "wget --no-check-certificate -nv -O - http://git.io/~dangra |bash -"
    exit
fi

set -x
git clone --bare https://github.com/dangra/dotfiles $GIT_DIR
git config --add remote.origin.pushurl git@github.com:dangra/dotfiles
echo '*' >>$GIT_DIR/info/exclude
#git submodule update --init
git reset --hard
